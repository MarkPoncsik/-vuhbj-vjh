<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–ê–Ω—Ç–∏—É—Ç–æ–ø—ñ—á–Ω–∞ –≥—Ä–∞</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background: linear-gradient(#000000, #001144, #3a0040);
      color: #ECECEC;
      font-family: sans-serif;
      min-height: 100vh;
      overflow: hidden;
    }
    .stage {
      position: absolute;
      top: 0; left: 0; width: 100%; height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity 0.5s ease;
    }
    .stage.active {
      opacity: 1;
    }
    /* Game 1 styles */
    #game1 { display: grid; gap: 2px; }
    #game1 .cell {
      width: 20px; height: 20px;
      display: flex; align-items: center; justify-content: center;
      background: #222; cursor: pointer;
      font-size: 14px; user-select: none;
    }
    #game1 .cell.found {
      background: #9a70f5; color: black;
    }
    /* Game 2 styles */
    #game2 {
      width: 80%;
      display: grid; gap: 10px;
      grid-template-columns: repeat(5, 1fr);
    }
    .card {
      width: 100%; padding-top: 100%; /* square */
      position: relative;
      cursor: pointer;
      background: #333;
      border-radius: 8px;
    }
    .card .emoji {
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      font-size: 24px;
      opacity: 0;
      transition: opacity 0.3s;
    }
    .card.flipped .emoji { opacity: 1; }
    .card.matched { background: #444; pointer-events: none; }
    /* Game 3 styles */
    #game3 {
      width: 100%;
      display: grid; grid-template-columns: repeat(auto-fill, 30px);
      gap: 5px; overflow: auto; justify-content: center;
    }
    .emoji3 {
      font-size: 24px;
      cursor: pointer;
    }
    /* Final screen */
    #final { padding: 20px; text-align: center; }
    #final .highlight { color: #FFDE59; }
  </style>
</head>
<body>
  <!-- –ì—Ä–∞ 1 -->
  <div id="game1Stage" class="stage active">
    <h2>–ì—Ä–∞ 1: –ó–Ω–∞–π–¥–∏ —Å–ª–æ–≤–æ</h2>
    <div id="game1"></div>
  </div>
  <!-- –ì—Ä–∞ 2 -->
  <div id="game2Stage" class="stage">
    <h2>–ì—Ä–∞ 2: –ó–Ω–∞–π–¥–∏ –ø–∞—Ä—É –µ–º–æ–¥–∑—ñ</h2>
    <div id="game2"></div>
  </div>
  <!-- –ì—Ä–∞ 3 -->
  <div id="game3Stage" class="stage">
    <h2>–ì—Ä–∞ 3: –ó–Ω–∞–π–¥–∏ üòä</h2>
    <div id="game3"></div>
  </div>
  <!-- –§—ñ–Ω–∞–ª -->
  <div id="finalStage" class="stage">
    <h2>–í—ñ—Ç–∞—î–º–æ!</h2>
    <p id="finalText"></p>
  </div>
<script>
(() => {
  let selectedWord = "";

  // --- Game 1: Word Search ---
  const words = ["—Å–≤–æ–±–æ–¥–∞","–¥—É–º–∞–π","–æ–ø—ñ—Ä"];
  const size = 15;
  const grid = Array.from({ length: size }, () => Array(size).fill(""));
  // Place two of each word
  function placeWord(word) {
    const len = word.length;
    let placed = false;
    while (!placed) {
      const horizontal = Math.random() < 0.5;
      const row = Math.floor(Math.random() * size);
      const col = Math.floor(Math.random() * size);
      if (horizontal) {
        if (col + len > size) continue;
        let ok = true;
        for (let i = 0; i < len; i++) {
          if (grid[row][col+i] && grid[row][col+i] !== word[i]) { ok = false; break; }
        }
        if (!ok) continue;
        for (let i = 0; i < len; i++) {
          grid[row][col+i] = word[i];
        }
        placed = true;
      } else {
        if (row + len > size) continue;
        let ok = true;
        for (let i = 0; i < len; i++) {
          if (grid[row+i][col] && grid[row+i][col] !== word[i]) { ok = false; break; }
        }
        if (!ok) continue;
        for (let i = 0; i < len; i++) {
          grid[row+i][col] = word[i];
        }
        placed = true;
      }
    }
  }
  words.forEach(word => { placeWord(word); placeWord(word); });
  // Fill empty with random letters
  const alphabet = "–∞–±–≤–≥–¥–µ—î–∂–∑–∏—ñ—ó–π–∫–ª–º–Ω–æ–ø—Ä—Å—Ç—É—Ñ—Ö—Ü—á—à—â—å—é—è";
  for (let r = 0; r < size; r++) {
    for (let c = 0; c < size; c++) {
      if (!grid[r][c]) {
        grid[r][c] = alphabet[Math.floor(Math.random()*alphabet.length)];
      }
    }
  }
  // Render grid
  const game1Div = document.getElementById("game1");
  game1Div.style.gridTemplateColumns = `repeat(${size}, 20px)`;
  let currentSelection = "";
  let cells = [];
  for (let r = 0; r < size; r++) {
    for (let c = 0; c < size; c++) {
      const cell = document.createElement("div");
      cell.className = "cell";
      cell.textContent = grid[r][c];
      cell.addEventListener("click", () => {
        currentSelection += grid[r][c];
        cell.classList.add("selected");
        // Check if prefix of any word
        const matchWord = words.find(w => w.startsWith(currentSelection));
        if (!matchWord) {
          // reset
          currentSelection = "";
          cells.forEach(x => x.classList.remove("selected"));
          cells = [];
          return;
        }
        cells.push(cell);
        if (currentSelection === matchWord) {
          // Found a word
          cells.forEach(x => x.classList.add("found"));
          selectedWord = matchWord;
          // Proceed to game 2
          document.getElementById("game1Stage").classList.remove("active");
          document.getElementById("game2Stage").classList.add("active");
        }
      });
      game1Div.appendChild(cell);
    }
  }
  
  // --- Game 2: Emoji Memory ---
  const emojis = ["üçé","üçå","üçá","üçì","üçâ","üçí","ü•ë","üçë","üçç","ü••"];
  let cards = emojis.concat(emojis);
  cards.sort(() => 0.5 - Math.random());
  const game2Div = document.getElementById("game2");
  let firstCard = null, lock = false;
  cards.forEach(sym => {
    const card = document.createElement("div");
    card.className = "card";
    const span = document.createElement("span");
    span.className = "emoji";
    span.textContent = sym;
    card.appendChild(span);
    card.addEventListener("click", () => {
      if (lock || card.classList.contains("flipped")) return;
      card.classList.add("flipped");
      if (!firstCard) {
        firstCard = card;
      } else {
        lock = true;
        const secondCard = card;
        if (firstCard.innerText === secondCard.innerText) {
          firstCard.classList.add("matched");
          secondCard.classList.add("matched");
          firstCard = null;
          lock = false;
          // Check if all matched
          if (document.querySelectorAll(".card.matched").length === cards.length) {
            document.getElementById("game2Stage").classList.remove("active");
            document.getElementById("game3Stage").classList.add("active");
          }
        } else {
          setTimeout(() => {
            firstCard.classList.remove("flipped");
            secondCard.classList.remove("flipped");
            firstCard = null;
            lock = false;
          }, 700);
        }
      }
    });
    game2Div.appendChild(card);
  });
  
  // --- Game 3: Find üòä ---
  const game3Div = document.getElementById("game3");
  const totalEmojis = 120;
  const happyIndex = Math.floor(Math.random() * totalEmojis);
  for (let i = 0; i < totalEmojis; i++) {
    const span = document.createElement("span");
    span.className = "emoji3";
    if (i === happyIndex) {
      span.textContent = "üòä";
      span.addEventListener("click", () => {
        // Go to final
        document.getElementById("game3Stage").classList.remove("active");
        document.getElementById("finalStage").classList.add("active");
        const finalText = document.getElementById("finalText");
        let msg = "";
        if (selectedWord === "—Å–≤–æ–±–æ–¥–∞") msg = "–¢–≤–æ—è –∂–∞–≥–∞ –¥–æ —Å–≤–æ–±–æ–¥–∏ –≤—Ä–∞–∂–∞—î. –í—ñ—Ç–∞—î–º–æ –∑ –ø—Ä–æ—Ö–æ–¥–∂–µ–Ω–Ω—è–º –≤–∏–ø—Ä–æ–±—É–≤–∞–Ω—å.";
        if (selectedWord === "–¥—É–º–∞–π") msg = "–¢–≤–æ—î –ø—Ä–∞–≥–Ω–µ–Ω–Ω—è –¥—É–º–∞—Ç–∏ –Ω–µ–±–µ–∑–ø–µ—á–Ω–µ –¥–ª—è —Å–∏—Å—Ç–µ–º–∏. –ê–ª–µ —Å–∞–º–µ –≤ —Ü—å–æ–º—É —Å–∏–ª–∞. –í—ñ—Ç–∞—î–º–æ –∑ –ø—Ä–æ—Ö–æ–¥–∂–µ–Ω–Ω—è–º –≤–∏–ø—Ä–æ–±—É–≤–∞–Ω—å.";
        if (selectedWord === "–æ–ø—ñ—Ä") msg = "–¢–≤–æ—è –∑–¥–∞—Ç–Ω—ñ—Å—Ç—å –¥–æ –æ–ø–æ—Ä—É —Ä–æ–±–∏—Ç—å —Ç–µ–±–µ –≤–æ—Ä–æ–≥–æ–º —Å–∏—Å—Ç–µ–º–∏ ‚Äî —ñ –Ω–∞–¥—ñ—î—é –¥–ª—è —ñ–Ω—à–∏—Ö. –í—ñ—Ç–∞—î–º–æ –∑ –ø—Ä–æ—Ö–æ–¥–∂–µ–Ω–Ω—è–º –≤–∏–ø—Ä–æ–±—É–≤–∞–Ω—å.";
        finalText.innerText = msg;
      });
    } else {
      span.textContent = "üòê";
      span.addEventListener("click", () => {
        /* –Ω—ñ—á–æ–≥–æ –Ω–µ —Ä–æ–±–∏–º–æ */
      });
    }
    game3Div.appendChild(span);
  }
})();
</script>
</body>
</html>
